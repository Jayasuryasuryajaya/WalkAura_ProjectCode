import{b as M,r as a,u as T,j as e,a as c,y as U}from"./index-CZ9p6afL.js";import{N as B}from"./NavBar-fgtI8Lsi.js";import"./icon-BvqI3lih.js";const H=({cart:y})=>{const N=M(),[l,C]=a.useState(""),[S,m]=a.useState(""),[v,o]=a.useState(!1),[w,D]=a.useState([]),[h,k]=a.useState(""),[u,x]=a.useState(""),{cartDatas:O,selectedSize:i,product:E}=N.state||{},[z,g]=a.useState(1),t=O||E,j=i||l,p=z,f=T();a.useEffect(()=>{(async()=>{try{const{data:r}=await c.get("http://localhost:3500/MyOrders");D(r.map(n=>n[0]))}catch(r){console.error("Error fetching orders:",r)}})()},[]),a.useEffect(()=>{(async()=>{var r,n,b;try{const{data:d}=await c.get("http://localhost:3500/CustomerInfo");k((n=(r=d[0])==null?void 0:r.number)==null?void 0:n.toString());const{data:L}=await c.get("http://localhost:3500/CreateUserData");x((b=L[0])==null?void 0:b.number)}catch(d){console.error("Error verifying address:",d),x(void 0)}})()},[]);const I=()=>g(s=>s+1),P=()=>g(s=>s>1?s-1:s),A=async()=>{if(w.some(s=>s.id===t.id))U.warning("The product is already ordered!");else if(j){const r=[{...t,size:j,Item:p}];try{o(!0),await c.post("http://localhost:3500/MyOrders",r,{headers:{"Content-Type":"application/json"}}),m(""),h&&u&&h===u?setTimeout(()=>{o(!1),f("/MyOrders")},3e3):f("/CustomerInfos")}catch(n){console.error("Error placing order:",n),o(!1)}}else m("Select Your size.")};return e.jsxs("div",{className:"container-fluid bg-dark text-white",children:[e.jsx(B,{cart:y}),e.jsxs("div",{className:"row d-flex justify-content-center align-items-center",style:{minHeight:"100vh"},children:[v&&e.jsxs("div",{className:"position-absolute top-0 start-0 w-100 h-100 d-flex justify-content-center align-items-center",style:{backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:1},children:[e.jsx("span",{className:"fw-bold fs-3 text-white mb-3",children:"Placing Your Orders!"}),e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})]}),t&&e.jsxs("div",{className:"card shadow-lg bg-light text-dark p-3",style:{width:"70%"},children:[e.jsx("h4",{className:"text-start fs-4",children:"Order Confirmation"}),e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-lg-6 col-md-6 col-sm-12 text-center",children:e.jsx("img",{src:t.images,alt:"Product",width:"300",height:"400",className:"img-fluid rounded"})}),e.jsxs("div",{className:"col-lg-6 col-md-6 col-sm-12",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",t.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Brand:"})," ",t.brand]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Total Price:"})," ",t.price]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Size:"}),i?e.jsxs("span",{className:"ms-2",children:[i," - Selected Size"]}):t.size.map((s,r)=>e.jsx("button",{className:`btn btn-outline-dark ms-1 ${s===l?"bg-dark text-white":""}`,onClick:()=>C(s),children:s},r))]}),e.jsx("span",{className:"text-danger",children:S}),e.jsx("div",{className:"d-flex align-items-center mt-2",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Product Count:"}),e.jsx("button",{className:"btn btn-outline-dark ms-3",onClick:P,children:"-"}),e.jsx("span",{className:"ms-2 me-2",children:p}),e.jsx("button",{className:"btn btn-outline-dark",onClick:I,children:"+"})]})}),e.jsxs("p",{children:[e.jsx("strong",{children:"Ratings:"})," ",t.ratings," ",e.jsx("i",{className:"bi bi-star-fill"})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Description:"})," ",t.description]}),e.jsx("div",{className:"text-center",children:e.jsx("button",{className:"btn btn-dark mb-3",onClick:A,children:"Continue Order"})})]})]})]})]})]})};export{H as default};
